!function(l){CartFlowsHelper={getUrlParameter:function(e){for(var t,a=decodeURIComponent(window.location.search.substring(1)).split("&"),r=0;r<a.length;r++)if((t=a[r].split("="))[0]===e)return void 0===t[1]||t[1]}};function w(e){e._nonce=cartflows_offer[e.action+"_nonce"],l.ajax({url:cartflows.ajax_url,data:e,dataType:"json",type:"POST",success:function(e){var t=e.message,a="wcf-payment-"+e.status;l("body").trigger("wcf-update-msg",[t,a]),setTimeout(function(){window.location.href=e.redirect},500)}})}function e(){var e,_,a,f,t=jQuery(".woocommerce-product-gallery");0<t.length&&1<t.find(".woocommerce-product-gallery__image").length&&(e=jQuery(".woocommerce-product-gallery").flexslider({animation:"slide",animationLoop:!1,controlNav:"thumbnails",selector:".slides .woocommerce-product-gallery__image",directionNav:!1}),l(window).on("load",function(){e.trigger("resize")}),0<(_=l(".variations_form")).length&&(a=function(o){var e=_,t=l(".woocommerce-product-gallery"),a=t.find(".flex-control-nav"),r=a.find("li:eq(0) img"),c=t.find(".woocommerce-product-gallery__image, .woocommerce-product-gallery__image--placeholder").eq(0),i=c.find(".wp-post-image"),n=c.find("a").eq(0);if(o&&o.image&&o.image.src&&1<o.image.src.length){0<a.find('li img[data-o_src="'+o.image.gallery_thumbnail_src+'"]').length&&f();a=a.find('li img[src="'+o.image.gallery_thumbnail_src+'"]');if(0<a.length)return a.trigger("click"),e.attr("current-image",o.image_id),void window.setTimeout(function(){l(window).trigger("resize"),t.trigger("woocommerce_gallery_init_zoom")},20);i.wc_set_variation_attr("src",o.image.src),i.wc_set_variation_attr("height",o.image.src_h),i.wc_set_variation_attr("width",o.image.src_w),i.wc_set_variation_attr("srcset",o.image.srcset),i.wc_set_variation_attr("sizes",o.image.sizes),i.wc_set_variation_attr("title",o.image.title),i.wc_set_variation_attr("data-caption",o.image.caption),i.wc_set_variation_attr("alt",o.image.alt),i.wc_set_variation_attr("data-src",o.image.full_src),i.wc_set_variation_attr("data-large_image",o.image.full_src),i.wc_set_variation_attr("data-large_image_width",o.image.full_src_w),i.wc_set_variation_attr("data-large_image_height",o.image.full_src_h),c.wc_set_variation_attr("data-thumb",o.image.src),r.wc_set_variation_attr("src",o.image.gallery_thumbnail_src),n.wc_set_variation_attr("href",o.image.full_src)}else f();window.setTimeout(function(){var e,t,a,r;l(window).trigger("resize"),e=o,t=_,a=l(".woocommerce-product-gallery"),r=!1,e=e&&e.image_id?e.image_id:"",t.attr("current-image")!==e&&(r=!0),t.attr("current-image",e),r&&a.flexslider(0)},20)},f=function(){var e=l(".woocommerce-product-gallery"),t=e.find(".flex-control-nav").find("li:eq(0) img"),a=e.find(".woocommerce-product-gallery__image, .woocommerce-product-gallery__image--placeholder").eq(0),r=a.find(".wp-post-image"),e=a.find("a").eq(0);r.wc_reset_variation_attr("src"),r.wc_reset_variation_attr("width"),r.wc_reset_variation_attr("height"),r.wc_reset_variation_attr("srcset"),r.wc_reset_variation_attr("sizes"),r.wc_reset_variation_attr("title"),r.wc_reset_variation_attr("data-caption"),r.wc_reset_variation_attr("alt"),r.wc_reset_variation_attr("data-src"),r.wc_reset_variation_attr("data-large_image"),r.wc_reset_variation_attr("data-large_image_width"),r.wc_reset_variation_attr("data-large_image_height"),a.wc_reset_variation_attr("data-thumb"),t.wc_reset_variation_attr("src"),e.wc_reset_variation_attr("href")},l(".variations_form").on("found_variation",function(e,t){a(t)})))}var p=function(t,e){"mollie_wc_gateway_creditcard"===e&&(t.action="wcf_mollie_creditcard_process",t._nonce=cartflows_offer.wcf_mollie_creditcard_process_nonce),"mollie_wc_gateway_ideal"===e&&(t.action="wcf_mollie_ideal_process",t._nonce=cartflows_offer.wcf_mollie_ideal_process_nonce),l.ajax({url:cartflows.ajax_url,data:t,dataType:"json",type:"POST",success:function(e){"success"===e.result?window.location.href=e.redirect:(t.action=action,w(t))}})},m=function(t,e){t.action="wcf_create_paypal_payments_order",t._nonce=cartflows_offer.wcf_create_paypal_order_nonce,l.ajax({url:cartflows.ajax_url,data:t,dataType:"json",type:"POST",success:function(e){"success"===e.status?window.location.href=e.redirect:(t.action="wcf_"+t.offer_type+"_accepted",w(t))}})};l(window).on("elementor/frontend/init",function(){elementorFrontend.hooks.addAction("frontend/element_ready/offer-product-image.default",e)});function o(){0<l(".wcf-offer-product-quantity").length&&l(".wcf-offer-product-quantity .qty").on("change",function(){var e=l(this).val();l(".wcf-offer-product-quantity .qty").val(e)}),0<l(".wcf-offer-product-variation .variations select").length?(l(".wcf-variable-price-range").show().siblings().remove(),l(".wcf-offer-product-variation .variations select").on("change",function(){l(".wcf-offer-product-variation").find(".variations_form");var e,t=l(this),a=t.data("attribute_name");0!=t.length&&(e=t.val(),l('.wcf-offer-product-variation [data-attribute_name ="'+a+'"]').each(function(){l(this).val(e),""==e||0==e?l(this).addClass("var_not_selected"):l(this).removeClass("var_not_selected")}))}),l(".variations_form").on("found_variation",function(e,t){var a=cartflows_offer.discount_type,r=cartflows_offer.discount_value,o=cartflows_offer.currency_symbol,c=t.display_price,t=t.display_price;0<r&&("discount_percent"===a?t-=t*r/100:"discount_price"===a&&(t-=r));r='<span class="wcf-single-variation-price">';c!==t?(r+='<span class="wcf-regular-price del">',r+=o+c.toFixed(2),r+="</span>",r+='<span class="wcf-discount-price">',r+=o+t.toFixed(2)):(r+='<span class="wcf-regular-price">',r+=o+c.toFixed(2)),r+="</span>",r+="</span>",l(".wcf-offer-price").html(r)})):(l(".wcf-variable-price-range").remove(),l(".wcf-offer-price-inner").show()),e()}l(function(r){var e,a,t;r("body").on("wcf-show-loader",function(e,t){"no"===t&&(jQuery(".wcf-note-yes").hide(),jQuery(".wcf-note-no").show(),jQuery(".wcf-process-msg").hide()),r(".wcf-loader-bg").addClass("show")}),r("body").on("wcf-hide-loader",function(e){r(".wcf-loader-bg").removeClass("show")}),r("body").on("wcf-update-msg",function(e,t,a){r(".wcf-order-msg .wcf-process-msg").text(t).addClass(a).show()}),l('a[href*="wcf-up-offer-yes"]').each(function(e){var t=l(this);0===e?t.attr("id","wcf-upsell-offer"):t.attr("id","wcf-upsell-offer-"+e)}),l('a[href*="wcf-down-offer-yes"]').each(function(e){var t=l(this);0===e?t.attr("id","wcf-downsell-offer"):t.attr("id","wcf-downsell-offer-"+e)}),l(document).on("click",'a[href*="wcf-up-offer"], a[href*="wcf-down-offer"]',function(e){e.preventDefault();var t=l(this).attr("href"),a="yes",r="upsell",o=cartflows_offer.step_id,c=cartflows_offer.product_id,i=cartflows_offer.order_id,n=cartflows_offer.order_key,_=0,f=0,e=cartflows.current_flow;if(-1!==t.indexOf("wcf-up-offer")&&(r="upsell",a=-1!==t.indexOf("wcf-up-offer-yes")?"yes":"no"),-1!==t.indexOf("wcf-down-offer")&&(r="downsell",a=-1!==t.indexOf("wcf-down-offer-yes")?"yes":"no"),"yes"===a){t=l(".wcf-offer-product-variation");if(0<t.length){var s=t.find(".variations_form"),t=s.find("input.variation_id"),_=parseInt(t.val());if(0<l(".var_not_selected").length||""===_||0===_)return s.find(".variations select").each(function(){0==l(this).val().length&&l(this).addClass("var_not_selected")}),l([document.documentElement,document.body]).animate({scrollTop:s.find(".variations select").offset().top-100},1e3),!1}}if("yes"!==cartflows_offer.skip_offer||"yes"!==a){l("body").trigger("wcf-show-loader",a),action="yes"===a?"wcf_"+r+"_accepted":"wcf_"+r+"_rejected";s=l(".wcf-offer-product-quantity");0<s.length&&(s=s.find('input[name="quantity"]'),0<(s=parseInt(s.val()))&&(f=s));var d={action:"",offer_action:a,offer_type:r,step_id:o,product_id:c,variation_id:_,input_qty:f,order_id:i,order_key:n,flow_id:e,stripe_sca_payment:!1,stripe_intent_id:"",_nonce:""};return"yes"===a?"stripe"===cartflows_offer.payment_method?(d.action="wcf_stripe_sca_check",d._nonce=cartflows_offer.wcf_stripe_sca_check_nonce,l.ajax({url:cartflows.ajax_url,data:d,dataType:"json",type:"POST",success:function(e){e.hasOwnProperty("intent_secret")?Stripe(e.stripe_pk).handleCardPayment(e.intent_secret).then(function(e){if(e.error)throw e.error;"requires_capture"!==e.paymentIntent.status&&"succeeded"!==e.paymentIntent.status||(d.action=action,d.stripe_sca_payment=!0,d.stripe_intent_id=e.paymentIntent.id,w(d))}).catch(function(e){window.location.reload()}):(d.action=action,w(d))}})):"mollie_wc_gateway_creditcard"===cartflows_offer.payment_method||"mollie_wc_gateway_ideal"===cartflows_offer.payment_method?p(d,cartflows_offer.payment_method):"ppcp-gateway"===cartflows_offer.payment_method?m(d,cartflows_offer.payment_method):(d.action=action,w(d)):(d.action=action,w(d)),!1}}),o(),"1"!==cartflows.is_pb_preview&&(jQuery(document).ajaxComplete(function(e,t,a){t.hasOwnProperty("responseJSON")&&((t=t.responseJSON.hasOwnProperty("fragments")?t.responseJSON.fragments:null)&&t.hasOwnProperty("added_to_cart_data")&&fbq("track","AddToCart",t.added_to_cart_data.added_to_cart),"enable"===(void 0!==cartflows.fb_setting?cartflows.fb_setting:cartflows.fb_active).facebook_pixel_add_payment_info&&t&&t.hasOwnProperty("fb_add_payment_info_data")&&(cartflows.fb_add_payment_info_data=t.fb_add_payment_info_data))}),jQuery(document).ajaxComplete(function(e,t,a){var r,o;t.hasOwnProperty("responseJSON")&&(r=(o=void 0!==cartflows.ga_setting?cartflows.ga_setting:cartflows.wcf_ga_active).enable_add_to_cart,o=o.enable_add_payment_info,cartflows.is_checkout_page&&(t=t.responseJSON.hasOwnProperty("fragments")?t.responseJSON.fragments:null,a.hasOwnProperty("data")&&-1!==a.data.indexOf("action=wcf_bump_order_process")&&("enable"===r&&(t&&t.hasOwnProperty("ga_added_to_cart_data")&&gtag("event","add_to_cart",JSON.parse(t.ga_added_to_cart_data.add_to_cart)),t&&t.hasOwnProperty("ga_remove_to_cart_data")&&gtag("event","remove_from_cart",JSON.parse(t.ga_remove_to_cart_data.remove_from_cart))),"enable"===o&&t&&t.hasOwnProperty("ga_add_payment_info_data")&&(cartflows.add_payment_info_data=t.ga_add_payment_info_data))))})),"undefined"!=typeof cartflows_offer&&(e="",CartFlowsHelper.getUrlParameter("wcf-mollie-return")&&("mollie_wc_gateway_creditcard"===cartflows_offer.payment_method&&(e=cartflows_offer.wcf_mollie_creditcard_process_nonce),"mollie_wc_gateway_ideal"===cartflows_offer.payment_method&&(e=cartflows_offer.wcf_mollie_ideal_process_nonce),t={action:"wcf_"+(t=cartflows_offer.offer_type)+"_accepted",offer_action:"yes",offer_type:t,step_id:cartflows_offer.step_id,product_id:cartflows_offer.product_id,order_id:cartflows_offer.order_id,order_key:cartflows_offer.order_key,flow_id:cartflows.current_flow,stripe_sca_payment:!1,stripe_intent_id:"",_nonce:e},w(t))),"undefined"!=typeof cartflows_offer&&(t=CartFlowsHelper.getUrlParameter("wcf-ppcp-return"),a="",t&&(t={action:"wcf_capture_paypal_order",step_id:cartflows_offer.step_id,order_id:cartflows_offer.order_id,_nonce:a=cartflows_offer.wcf_capture_paypal_order_nonce},l("body").trigger("wcf-show-loader","yes"),l.ajax({url:cartflows.ajax_url,data:t,dataType:"json",type:"POST",success:function(e){var t;"success"===e.status?(t=cartflows_offer.offer_type,t={action:"wcf_"+t+"_accepted",offer_action:"yes",offer_type:t,step_id:cartflows_offer.step_id,product_id:cartflows_offer.product_id,order_id:cartflows_offer.order_id,order_key:cartflows_offer.order_key,flow_id:cartflows.current_flow,stripe_sca_payment:!1,stripe_intent_id:"",_nonce:a}):t.action=t.action="wcf_"+t.offer_type+"_accepted",w(t)}})))})}(jQuery);