!function(l){CartFlowsProLicense={init:function(){this._check_popup(),this._bind()},_check_popup:function(){var e=CartFlowsProLicense;(e._getUrlParameter("cartflows-license-popup")||"")&&"Deactivated"==CartFlowsProLicenseVars.activation_status&&e._open_popup()},_bind:function(){l(document).on("click",".cartflows-license-popup-open-button",CartFlowsProLicense._export_button_click),l(document).on("click",".cartflows-close-popup-button",CartFlowsProLicense._close_popup),l(document).on("click","#cartflows-license-popup-overlay",CartFlowsProLicense._close_popup),l(document).on("click",".cartflows-activate-license",CartFlowsProLicense._activate_license),l(document).on("click",".cartflows-deactivate-license",CartFlowsProLicense._deactivate_license)},_log:function(e){(new Date).toLocaleTimeString()},_export_button_click:function(e){e.preventDefault(),CartFlowsProLicense._open_popup()},_open_popup:function(){var e=l("#cartflows-license-popup-overlay, #cartflows-license-popup"),t=l("#cartflows-license-popup").attr("data-license-key")||"",a=e.find(".contents");"Activated"==t?a.html(wp.template("cartflows-deactivate-license")):a.html(wp.template("cartflows-activate-license")),e.show()},_close_popup:function(){var e=l("#cartflows-license-popup-overlay, #cartflows-license-popup");e.hasClass("validating")&&!confirm("WARNING! License request not complete!!\n\nPlease wait for a moment until complete the license request.")||e.hide()},_activate_license:function(e){e.preventDefault();CartFlowsProLicense;var n=l(this),i=l("#cartflows-license-popup"),c=i.find(".contents"),o=l(".cartflows-license-popup-open-button"),s=i.find(".license_key").val()||"",e=i.find(".license_nonce").val()||"";s.length&&(n.hasClass("disabled")||n.hasClass("validating")||(i.addClass("validating"),n.find(".text").text("Validating.."),c.find(".notice").length&&c.find(".notice").remove(),n.find(".cartflows-processing").addClass("is-active"),l.ajax({url:ajaxurl,type:"POST",data:{action:"cartflows_activate_license",license_key:s,security:e}}).done(function(e,t,a){i.removeClass("validating"),n.find(".cartflows-processing").removeClass("is-active"),e.success?(o.removeClass("active").addClass("inactive").text("Deactivate License"),n.find(".text").text("Successfully Activated! Reloading.."),i.attr("data-license-key",s),setTimeout(function(){location.reload()},2500),i.find("input").addClass("disabled").attr("readonly","readonly")):((e=e.data.error||e.data||"")&&c.append('<div class="notice notice-error"><p>'+e+"</p></div>"),n.find(".text").text("Failed!"))}).fail(function(e,t){}).always(function(){})))},_deactivate_license:function(e){e.preventDefault();var n=l(this),i=l(".cartflows-license-popup-open-button"),c=l("#cartflows-license-popup"),o=c.find(".contents"),e=(c.find(".license_key").val(),c.find(".deactivate_license_nonce").val()||"");c.addClass("validating"),n.find(".text").text("Deactivating.."),o.find(".notice").length&&o.find(".notice").remove(),n.find(".cartflows-processing").addClass("is-active"),l.ajax({url:ajaxurl,type:"POST",data:{action:"cartflows_deactivate_license",security:e}}).done(function(e,t,a){c.removeClass("validating"),n.find(".cartflows-processing").removeClass("is-active"),e.success?(i.removeClass("inactive").addClass("active").text("Activate License"),n.find(".text").text("Successfully Deactivated! Reloading.."),c.attr("data-license-key",""),setTimeout(function(){location.reload()},2500)):((e=e.data.message||e.data||e.response||"")&&o.append('<div class="notice notice-error"><p>'+e+"</p></div>"),n.find(".text").text("Failed!"))}).fail(function(e,t){}).always(function(){})},_getUrlParameter:function(e){for(var t,a=decodeURIComponent(window.location.search.substring(1)).split("&"),n=0;n<a.length;n++)if((t=a[n].split("="))[0]===e)return void 0===t[1]||t[1]}},l(function(){CartFlowsProLicense.init()})}(jQuery);